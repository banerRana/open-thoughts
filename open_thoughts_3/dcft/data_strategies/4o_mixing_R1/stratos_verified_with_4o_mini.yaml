operators:
- id: hf_source
  config:
    type: hf_source
    dataset: mlfoundations-dev/stratos_verified_mix
    split: train
- id: extract_questions
  config:
    type: function
    function: data_strategies.DeepSeekR1.utils.create_question_column
  input_ids:
    - hf_source
- id: annotate_instruction
  config:
    type: completions
    map: chat
    require_all_responses: false
    map_config:
      user_message_column: extracted_instruction
      output_column: completion
    model: gpt-4o-mini
    batch: false
  input_ids:
  - extract_questions
- id: convert_to_sharegpt
  config:
    type: function
    function: data_strategies.commons.convert_instruction_response_to_sharegpt
    function_config:
      input_instruction_column: extracted_instruction
      input_response_column: completion
      output_sharegpt_column: conversations
  input_ids:
    - annotate_instruction
- id: mix
  config:
    type: mix
  input_ids:
    - hf_source
    - convert_to_sharegpt