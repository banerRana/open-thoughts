operators:
  - id: load_DCLM_baseline
    config:
      type: local_json_source
      directory: /data/horse/ws/rehe951g-p_finetuning/DCLM-baseline-subset
      sharded: true
      num_shards: 16

  - id: clean_DCLM_baseline
    config:
      type: function
      function: data_strategies.WebInstruct.utils.clean_dataset
      function_config:
        input_column: text
        output_column: cleaned_text
        remove_columns: 
          - bff_contained_ngram_count_before_dedupe
          - metadata
          - previous_word_count
          - warcinfo
          - language_id_whole_page_fasttext
      sharded: true
      materialize_output: false
    input_ids:
      - load_DCLM_baseline

  - id: classify_fasttext
    config:
      type: fasttext
      hf_repo_id: mlfoundations-dev/wi_reasoning_fasttext_training
      input_column: cleaned_text
      target_label: "__label__QA_doc"
      filter_threshold: 0.3
    input_ids:
      - clean_DCLM_baseline

