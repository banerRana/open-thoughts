operators:
  # - id: load_answers
  #   config:
  #     type: load_preexisting
  #     framework_name: pdf_qa_r1_annotation
  - id: load_answers
    config:
      type: hf_source
      dataset: mlfoundations-dev/pdf_r1_annotation_verifiable_questions
      split: train
  - id: judge
    config: 
      type: completions
      map: deepseek_judge
      model: gpt-4o-mini
      map_config:
        question_column: improved_question_solution
        ground_truth_column: extracted_solution
        answer_column: r1_distill_70b_response
    input_ids:
      - load_answers
  - id: select_true
    config:
      type: function
      function: data_strategies.commons.select_rows
      function_config:
        conditions:
          correct: True
    input_ids:
      - judge


  - id: convert_to_sharegpt
    config:
      type: function
      function: data_strategies.commons.convert_instruction_response_to_sharegpt
      function_config:
        input_instruction_column: improved_question_solution
        input_response_column: r1_distill_70b_response
        output_sharegpt_column: conversations
    input_ids:
      - select_true
  - id: hf_source
    config:
      type: hf_source
      dataset: open-thoughts/OpenThoughts-114k
      split: train
  - id: mix
    config:
      type: mix
    input_ids:
      - hf_source
      - convert_to_sharegpt

