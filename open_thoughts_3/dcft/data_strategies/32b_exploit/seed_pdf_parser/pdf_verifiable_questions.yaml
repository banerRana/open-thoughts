operators:
  - id: hf_source
    config:
      type: hf_source
      dataset: mlfoundations-dev/all_filtered_pdfs_pipeline
      split: train
  - id: drop_columns
    config:
      type: function
      function: data_strategies.commons.keep_only_columns
      function_config:
        columns_to_keep:
          - url
          - page_number
          - improved_question_solution
          - extracted_answer_choices
          - extracted_solution
    input_ids:
        - hf_source
  - id: filter_leaked_solutions
    config:
      type: function
      function: data_strategies.32b_exploit.pdf_helper.filter_questions_with_the_answer_in_them
    input_ids:
      - drop_columns
  - id: sample_dataset
    config:
      type: function
      function: data_strategies.commons.uniform_sample_limited
      function_config:
        num_samples: 2500
    input_ids:
      - filter_leaked_solutions

