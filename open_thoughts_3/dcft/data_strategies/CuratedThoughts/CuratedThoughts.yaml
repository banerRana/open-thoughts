operators:
  - id: load_hf
    config:
      type: hf_source
      dataset: bethgelab/CuratedThoughts
      subset: OpenThoughts-114k-metadata
      split: train
  - id: concatenate_columns
    config:
      type: function
      function: data_strategies.commons.concatenate_columns
      function_config:
        first_column: deepseek_reasoning
        second_column: deepseek_solution
        output_column: final_response
        start_token: <|begin_of_thought>\n\n
        separator_token: <|end_of_thought>\n\n<|begin_of_solution>\n\n
        end_token: \n\n<|end_of_solution|>
    input_ids:
      - load_hf
  - id: convert_to_sharegpt
    config:
      type: function
      function: data_strategies.commons.convert_instruction_response_to_sharegpt
      function_config:
        input_instruction_column: problem
        input_response_column: final_response
        output_sharegpt_column: conversations
    input_ids:
      - concatenate_columns