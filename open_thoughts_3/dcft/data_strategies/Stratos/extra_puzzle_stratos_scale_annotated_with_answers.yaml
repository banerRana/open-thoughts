operators:
- id: hf_source
  config:
    type: hf_source
    dataset: mlfoundations-dev/etash_science_puzzle
    split: train
- id: hf_source_2
  config:
    type: hf_source
    dataset: mlfoundations-dev/etash_science_puzzle_annotated
    split: train
- id: merge
  config:
    type: merge
    join_column: problem
  input_ids:
  - hf_source_2
  - hf_source
- id: judge
  config:
    type: completions
    map: deepseek_judge
    model: gpt-4o-mini
    map_config:
      ground_truth_column: ground_truth_solution
      answer_column: deepseek_solution
  input_ids:
    - merge
- id: select_true
  config:
    type: function
    function: data_strategies.commons.select_rows
    function_config:
      conditions:
        correct: True
  input_ids:
    - judge
- id: convert
  config:
    type: function
    function: data_strategies.Stratos.etash_utils.convert_to_share_gpt
    function_config:
      user_column: problem
  input_ids:
  -  select_true