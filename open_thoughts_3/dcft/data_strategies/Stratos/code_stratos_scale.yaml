operators:
  - id: load_code_contests
    config:
      type: "hf_source"
      dataset: "mlfoundations-dev/code_stratos_scale_pre_decontamination"
      split: train
  - id: label_code
    config:
      type: function
      function: data_strategies.commons.add_constant_columns
      function_config:
        source: code_stratos
    input_ids:
      - load_code_contests
  - id: load_code_golf
    config:
      type: load_preexisting
      framework: etash_code_golf
  - id: decontaminate
    config:
      type: cpu_function
      num_cpus: 80
      function:  data_strategies.DeepSeekR1.utils.decontaminate_table
      function_config:
        column: problem
        eval_datasets:
          - HuggingFaceH4/MATH-500
          - Maxwell-Jia/AIME_2024
          - AI-MO/aimo-validation-amc
          - livecodebench/code_generation_lite
        eval_columns:
          - problem
          - Problem
          - problem
          - question_content
        eval_splits:
          - test
          - train
          - train
          - test
        similarity_threshold: 95.0
    input_ids:
      - load_code_contests
  - id: fuzzy_dedup
    config:
      type: cpu_function
      num_cpus: 80
      function: data_strategies.DeepSeekR1.utils.fuzzy_dedup
      function_config:
        column: problem
        similarity_threshold: 95.0
    input_ids:
      - decontaminate