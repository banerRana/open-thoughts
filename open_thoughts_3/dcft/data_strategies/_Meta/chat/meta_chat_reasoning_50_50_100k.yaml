operators:
- id: load_hf
  config:
    type: hf_source
    dataset: open-thoughts/OpenThoughts-114k
    split: train
    subset: metadata
    trust_remote_code: True
- id: reasoning_create_reasoning_trace
  config:
    type: function
    function: data_strategies.commons.convert_reasoning_trace_to_final
    function_config:
      reasoning_column: deepseek_reasoning
      solution_column: deepseek_solution
      output_column: final_reasoning_trace
  input_ids:
  - load_hf 
- id: reasoning_convert_to_sharegpt
  config:
    type: function
    function: data_strategies.commons.convert_instruction_response_to_sharegpt
    function_config:
      input_instruction_column: problem
      input_response_column: final_reasoning_trace
      output_sharegpt_column: conversations
  input_ids:
  - reasoning_create_reasoning_trace 

- id: load_chat
  config:
    type: hf_source
    dataset: mlfoundations-dev/oh-dcft-v3.1-llama-3.1-nemotron-70b
    split: train


- id: sample_chat
  config:
    type: function
    function: data_strategies.commons.uniform_sample_fixed
    function_config:
      num_samples: 50_000
  input_ids:
  - load_chat
- id: sample_reasoning
  config:
    type: function
    function: data_strategies.commons.uniform_sample_fixed
    function_config:
      num_samples: 50_000
  input_ids:
  - reasoning_convert_to_sharegpt

- id: add_chat_type
  config:
    type: function
    function: data_strategies.commons.add_constant_columns
    function_config:
      type: "chat"
  input_ids:
  - sample_chat

- id: add_reasoning_type
  config:
    type: function
    function: data_strategies.commons.add_constant_columns
    function_config:
      type: "reasoning"
  input_ids:
  - sample_reasoning

- id: mix
  config:
    type: mix
  input_ids:
  - add_chat_type
  - add_reasoning_type