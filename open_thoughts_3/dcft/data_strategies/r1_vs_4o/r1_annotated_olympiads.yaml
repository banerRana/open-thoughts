operators:
  - id: load_numina_math
    config:
      type: "hf_source"
      dataset: "AI-MO/NuminaMath-CoT"
      split: train
  - id: sample_dataset
    config:
      type: function
      function: data_strategies.commons.uniform_sample_limited
      function_config:
        num_samples: 1000000
    input_ids:
      - load_numina_math
  - id: select_olympiads
    config:
      type: function
      function: data_strategies.commons.select_rows
      function_config:
        conditions:
          source: olympiads
    input_ids:
      - sample_dataset
  - id: load_annotations
    config:
      type: "hf_source"
      dataset: "mlfoundations-dev/math_stratos_scale_judged_and_annotated"
      split: train
  - id: join_on_problem
    config:
      type: merge
      escapechar: "\\"
      chunk_size: 100
      join_column: problem
    input_ids:
      - load_annotations
      - select_olympiads
  - id: refilter
    config:
      type: function
      function: data_strategies.commons.select_rows
      function_config:
        conditions:
          source: olympiads
    input_ids:
      - join_on_problem
  - id: convert_to_sharegpt
    config:
      type: function
      function: data_strategies.commons.convert_instruction_response_to_sharegpt
      function_config:
        input_instruction_column: problem
        input_response_column: reasoning
        output_sharegpt_column: conversations
    input_ids:
      - refilter