name: random_dclm_rw_docs
operators:
  - id: sample_dclm_refined_web_shards
    config:
      type: dclm_refinedweb_source
      num_shards: 10
      seed: 500
      s3_bucket: commoncrawl
      s3_prefix: contrib/datacomp/DCLM-refinedweb/

  - id: sample_dclm_refinedweb_docs
    config:
      type: function
      function: data_strategies.commons.uniform_sample
      function_config:
        num_samples: 16_000
    input_ids:
      - sample_dclm_refined_web_shards
      
  - id: clean_dclm_refinedweb_docs
    config:
      type: function
      function: data_strategies.WebInstruct.utils.clean_dataset
      function_config:
        input_column: text
        output_column: cleaned_text
    input_ids:
      - sample_dclm_refinedweb_docs