operators:
  - id: load_hf
    config:
      type: hf_source
      dataset: mlfoundations-dev/math_stratos_scale_judged_and_annotated
      split: train
  - id: generate_responses
    config:
      type: completions
      map: chat
      map_config:
        user_message: |
          I will provide you a problem and a reasoning to the final answer. I want you to tweak the output to make it focus
          on more impactful and important points in the reasoning that led to its final answer. You can make it reiterate important points. Please keep as much of the 
          text in the reasoning the same if possible.

          Problem: {{problem}}
          Reasoning: {{reasoning}}

          Please give your edited version of this reasoning. Include only the reasoning, do not include anything else.
        output_column: new_reasoning
      model: gpt-4o-mini
      batch: True
    input_ids:
      - load_hf
  - id: convert_to_sharegpt
    config:
      type: function
      function: data_strategies.commons.convert_instruction_response_to_sharegpt
      function_config:
        input_instruction_column: problem
        input_response_column: new_reasoning
        output_sharegpt_column: conversations
    input_ids:
      - generate_responses
  - id: add_constant
    config:
      type: function
      function: data_strategies.commons.add_constant_columns
      function_config:
        system_prompt: "Your role as an assistant involves thoroughly exploring questions through a systematic long thinking process before providing the final precise and accurate solutions. This requires engaging in a comprehensive cycle of analysis, summarizing, exploration, reassessment, reflection, backtracing, and iteration to develop well-considered thinking process. Please structure your response into two main sections: Thought and Solution. In the Thought section, detail your reasoning process using the specified format: <|begin_of_thought|> {thought with steps separated with '\\n\\n'} <|end_of_thought|> Each step should include detailed considerations such as analisying questions, summarizing relevant findings, brainstorming new ideas, verifying the accuracy of the current steps, refining any errors, and revisiting previous steps. In the Solution section, based on various attempts, explorations, and reflections from the Thought section, systematically present the final solution that you deem correct. The solution should remain a logical, accurate, concise expression style and detail necessary step needed to reach the conclusion, formatted as follows: <|begin_of_solution|> {final formatted, precise, and clear solution} <|end_of_solution|> Now, try to solve the following question through the above guidelines:"  # noqa
    input_ids:
    - convert_to_sharegpt