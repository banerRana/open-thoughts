operators: 
  - id: load_seed_code
    config:
      type: load_preexisting
      framework_name: seed_code_exploit_etash
  - id: load_seed_math
    config:
      type: load_preexisting
      framework_name: seed_math_exploit_difficulty_annotation
  - id: fuzzy_dedup
    config:
      type: cpu_function
      num_cpus: 80
      function: data_strategies.DeepSeekR1.utils.fuzzy_dedup
      function_config:
        column: problem
        similarity_threshold: 100.0
    input_ids:
      -  load_seed_code
      -  load_seed_math
  - id: sample_dataset
    config:
      type: function
      function: data_strategies.commons.uniform_sample_fixed
      function_config:
        num_samples: 10_000
    input_ids:
    - fuzzy_dedup
  - id: annotate_r1_distill_70b
    config:
      type: completions
      map: deepseek_reasoner
      map_config:
        input_problem_column: problem
      model: deepseek-reasoner
      batch: False
      temperature: 1.0
      backend: openai_client
      backend_params:
        max_requests_per_minute: 2_500
        max_tokens_per_minute: 1_000_000_000
        api_key: API_KEY
        base_url: "https://api.deepseek.com/"
        invalid_finish_reasons: ['content_filter']
    input_ids:
      - sample_dataset
  - id: convert_reasoning_trace_to_final
    config:
      type: function
      function: data_strategies.commons.convert_reasoning_trace_to_final
      function_config:
        reasoning_column: reasoning
        solution_column: deepseek_solution
        output_column: final_reasoning_trace
    input_ids:
    - annotate_r1_distill_70b
  - id: convert_to_sharegpt
    config:
      type: function
      function: data_strategies.commons.convert_instruction_response_to_sharegpt
      function_config:
        input_instruction_column: problem
        input_response_column: final_reasoning_trace
        output_sharegpt_column: conversations
    input_ids:
      - convert_reasoning_trace_to_final
