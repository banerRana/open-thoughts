operators:
  - id: load_numina_math
    config:
      type: "hf_source"
      dataset: "NovaSky-AI/labeled_numina_difficulty_162K"
      split: train
  - id: select_amc_aime
    config:
      type: function
      function: data_strategies.commons.select_rows
      function_config:
        conditions:
          source: amc_aime
    input_ids:
      - load_numina_math
  - id: select_math
    config:
      type: function
      function: data_strategies.commons.select_rows
      function_config:
        conditions:
          source: math
    input_ids:
      - load_numina_math
  - id: select_olympiad
    config:
      type: function
      function: data_strategies.commons.select_rows
      function_config:
        conditions:
          source: olympiad
    input_ids:
      - load_numina_math
  - id: get_evolution_prompt
    config:
      type: function
      function: data_strategies.OpenMathInstruct.utils.create_new_prompt
      function_config:
        question_column: problem
    input_ids:
      - select_olympiad
      - select_math
      - select_amc_aime
  - id: generate_new_questions
    config:
      type: completions
      model: gpt-4o-mini
      map: chat
      map_config:
        user_message_column: prompt_for_new_question
        output_column: response
        output_column: new_question
      temperature: 0.7  
      batch: false
    input_ids: 
      - get_evolution_prompt
  
    
