operators:
  - id: load_preexisting
    config:
      type: load_preexisting
      framework_name: base_get_openr1_hf
  - id: sample_dataset
    config:
      type: function
      function: data_strategies.commons.uniform_sample_fixed
      function_config:
        num_samples: 10_000
    input_ids:
    - load_preexisting
  - id: merge_together
    config:
      type: high_memory_function
      sharded: true
      num_shards: 10
      memory: 200
      function: data_strategies.TestTime.generator.merge_duplicate_rows
      function_config:
        diff_columns: 
          - generation
    input_ids:
      - sample_dataset
  - id: all_verification
    config:
      type: function
      sharded: true
      num_shards: 10
      function: data_strategies.MultipleSamples.utils.all_verification
      function_config:
        response_column: generation
        verified_response_column: verified_generation
    input_ids:
    - merge_together
  - id: convert_to_sharegpt
    config:
      type: function
      sharded: true
      num_shards: 10
      function: data_strategies.commons.convert_instruction_response_to_sharegpt
      function_config:
        input_instruction_column: problem
        input_response_column: verified_generation
        output_sharegpt_column: conversations
    input_ids:
      - all_verification
